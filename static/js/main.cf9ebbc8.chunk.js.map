{"version":3,"sources":["components/App/App.module.scss","components/SchemaErrors/SchemaErrors.module.scss","components/Emulator/Emulator.module.scss","hooks/useOnChange.ts","hooks/useHandler.ts","hooks/useLatest.ts","hooks/useWindowEvent.ts","common/types.ts","hooks/useRefState.ts","common/data.ts","common/common.ts","components/TruthTable/TruthTable.tsx","components/SchemaErrors/SchemaErrors.tsx","components/Emulator/Emulator.tsx","hooks/useForceUpdate.ts","utils/canvas.ts","components/App/App.tsx","index.tsx","components/TruthTable/TruthTable.module.scss"],"names":["module","exports","useOnChange","callback","deps","initRef","useRef","useEffect","current","useHandler","callbackRef","some","ref","useLatest","useCallback","useWindowEvent","eventName","func","window","addEventListener","removeEventListener","ElementType","useRefState","value","elementsDescriptions","PNP","pins","pos","x","y","NPN","POWER","GROUND","INPUT","OUTPUT","DOT","INPUT_LITERALS","OUTPUT_LITERALS","getLiteralForSignal","elements","element","isVector","index","indexOf","charVariants","type","length","charAt","TruthTable","options","onOptionsChange","useMemo","inputs","filter","el","outputs","renderInputs","renderOutputs","isInputVector","reverse","isOutputVector","className","styles","wrapper","option","checked","onChange","e","target","table","map","i","tableCell","Array","from","rowIndex","cellIndex","Math","floor","SchemaErrors","state","errors","used","connections","connection","p","elId","id","pinIndex","push","title","line","LoadingStatus","ICON_SIZE","FOCUS_SIZE","getNextId","lastElement","match","Error","parseInt","yesNo","yes","no","Emulator","draw","gameId","canvasRef","canvasWrapperRef","forceUpdate","incRef","useState","setInc","useForceUpdate","cursor","setCursor","setOptions","densityFactor","factor","devicePixelRatio","size","width","height","assets","x1","images","status","NONE","x2","mousePos","hoverElement","undefined","focusElement","movingElement","wireElement","source","mouseState","isMouseDown","isDrag","convertScreenCoordsToAppCoords","clearState","loadGameState","json","localStorage","getItem","JSON","parse","savedPos","savedOptions","setTimeout","intervalId","setInterval","clearInterval","getElById","find","actualizeDensityFactor","updateSize","app","canvas","clientWidth","clientHeight","checkOverlap","point","addElement","loadAssets","is2x","assetsSet","loadImages","remainLoad","LOADING","imgName","image","Image","src","onLoad","DONE","startWiring","ctx","getContext","getCanvasContext","save","clearRect","translate","scale","strokeStyle","lineWidth","strokeRect","restore","p1","p2","el1","el2","pin1","pin2","beginPath","moveTo","lineTo","stroke","x0","y0","currentCursor","char","textAlign","textBaseline","font","fillText","main","fallback","img","drawImage","activeTarget","pin","isActive","activePin","isWire","arc","PIN_DOT_RADIUS","PI","closePath","fillStyle","fill","onMouseUp","preventDefault","button","needRepaint","hoverTarget","canvasWrapper","cn","canvasScale","style","onClick","onMouseDown","onMouseMove","clientX","clientY","checkHover","isMoving","Boolean","movementX","movementY","onMouseLeave","resetCursorState","onContextMenu","panel","divider","setItem","stringify","console","info","href","update","space","debugPanel","getCurrentGameId","allowedIds","hash","location","trim","replace","includes","App","savedGames","currentGames","setCurrentGames","currentGameId","setCurrentGameId","gamesTitle","removeButton","confirm","removeItem","newGameId","lastId","getNextGameId","assign","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.cf9ebbc8.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"App_wrapper__1Jn2B\",\"title\":\"App_title__2C-7r\",\"gamesTitle\":\"App_gamesTitle__zqWFJ\",\"removeButton\":\"App_removeButton__1M5gF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"SchemaErrors_title__DGpx-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"Emulator_app__T00XQ\",\"panel\":\"Emulator_panel__NbdHB\",\"button\":\"Emulator_button__3x9P5\",\"canvasWrapper\":\"Emulator_canvasWrapper__1jUgz\",\"canvas\":\"Emulator_canvas__18vZ6\",\"canvasScale\":\"Emulator_canvasScale__1gfv0\",\"info\":\"Emulator_info__XN-lN\",\"divider\":\"Emulator_divider__1O1xo\",\"space\":\"Emulator_space__3sZL6\",\"yes\":\"Emulator_yes__2HVG8\",\"no\":\"Emulator_no__3K5j9\"};","import { useEffect, DependencyList, useRef } from 'react';\n\nexport function useOnChange(callback: () => void, deps: DependencyList) {\n  const initRef = useRef(false);\n\n  useEffect(() => {\n    if (!initRef.current) {\n      initRef.current = true;\n      return;\n    }\n\n    callback();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps);\n}\n","import { useCallback } from 'react';\nimport { useLatest } from './useLatest';\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function useHandler<F extends (...args: any) => any>(callback: F): F {\n  const callbackRef = useLatest<F>(callback);\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  return useCallback(\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    ((...args: any) => callbackRef.current(...args)) as any,\n    [],\n  );\n}\n","import { useRef } from 'react';\n\nexport function useLatest<T>(some: T): { current: T } {\n  const ref = useRef(some);\n  ref.current = some;\n  return ref;\n}\n","import { useEffect } from 'react';\n\nimport { useHandler } from 'hooks/useHandler';\n\nexport function useWindowEvent(\n  eventName: string,\n  callback: (...args: unknown[]) => void,\n) {\n  const func = useHandler(callback);\n\n  useEffect(() => {\n    window.addEventListener(eventName, func, false);\n\n    return () => {\n      window.removeEventListener(eventName, func, false);\n    };\n  }, [eventName, func]);\n}\n","export type GameId = `g${number}`;\n\nexport enum ElementType {\n  PNP = 'pnp',\n  NPN = 'npn',\n  POWER = 'power',\n  GROUND = 'ground',\n  INPUT = 'input',\n  OUTPUT = 'output',\n  DOT = 'dot',\n}\n\nexport type Coords = {\n  x: number;\n  y: number;\n};\n\nexport type ElementId = `el${number}`;\n\nexport type Element = {\n  type: ElementType;\n  id: ElementId;\n  pos: Coords;\n};\n\nexport type ConnectionPin = { elId: ElementId; pinIndex: number };\n\nexport type Connection = [ConnectionPin, ConnectionPin];\n\nexport type Pin = {\n  pos: Coords;\n};\n\nexport type ElementDescription = {\n  pins: Pin[];\n};\n\nexport type GameState = {\n  elements: Element[];\n  connections: Connection[];\n};\n\nexport type Options = {\n  isInputVector: boolean;\n  isOutputVector: boolean;\n};\n","import { useRef } from 'react';\n\nexport function useRefState<D>(value: D): D {\n  const ref = useRef<D>(value);\n  return ref.current;\n}\n","import { ElementType, ElementDescription } from './types';\n\nexport const elementsDescriptions: Record<ElementType, ElementDescription> = {\n  [ElementType.PNP]: {\n    pins: [\n      { pos: { x: 0.47, y: 0.94 } },\n      { pos: { x: -0.07, y: 0.32 } },\n      { pos: { x: 1.05, y: 0.32 } },\n    ],\n  },\n  [ElementType.NPN]: {\n    pins: [\n      { pos: { x: 0.47, y: 1 } },\n      { pos: { x: -0.07, y: 0.33 } },\n      { pos: { x: 1.05, y: 0.32 } },\n    ],\n  },\n  [ElementType.POWER]: {\n    pins: [{ pos: { x: 0.52, y: 0.8 } }],\n  },\n  [ElementType.GROUND]: {\n    pins: [{ pos: { x: 0.46, y: 0.15 } }],\n  },\n  [ElementType.INPUT]: {\n    pins: [{ pos: { x: 0.5, y: 0.8 } }],\n  },\n  [ElementType.OUTPUT]: {\n    pins: [{ pos: { x: 0.2, y: 0.5 } }],\n  },\n  [ElementType.DOT]: {\n    pins: [{ pos: { x: 0.5, y: 0.5 } }],\n  },\n};\n","import { Element, ElementType } from './types';\n\nconst INPUT_LITERALS = 'ABCDEFGHIJ';\nconst OUTPUT_LITERALS = 'YZXWVUTSRQ';\n\nexport function getLiteralForSignal(\n  elements: Element[],\n  element: Element,\n  isVector = false,\n): string {\n  const index = elements.indexOf(element);\n\n  const charVariants =\n    element.type === ElementType.INPUT ? INPUT_LITERALS : OUTPUT_LITERALS;\n\n  if (!isVector && elements.length <= charVariants.length) {\n    return charVariants.charAt(index);\n  }\n\n  return element.type === ElementType.INPUT ? `I${index}` : `Y${index}`;\n}\n","import { useMemo } from 'react';\n\nimport { getLiteralForSignal } from 'common/common';\nimport { Element, ElementType, Options } from 'common/types';\n\nimport styles from './TruthTable.module.scss';\n\ntype Props = {\n  elements: Element[];\n  options: Options;\n  onOptionsChange: (update: Partial<Options>) => void;\n};\n\nexport function TruthTable({ elements, options, onOptionsChange }: Props) {\n  const { inputs, outputs, renderInputs, renderOutputs } = useMemo(() => {\n    const inputs = elements.filter((el) => el.type === ElementType.INPUT);\n    const outputs = elements.filter((el) => el.type === ElementType.OUTPUT);\n\n    let renderInputs = inputs;\n    let renderOutputs = outputs;\n\n    if (options.isInputVector) {\n      renderInputs = [...inputs].reverse();\n    }\n\n    if (options.isOutputVector) {\n      renderOutputs = [...outputs].reverse();\n    }\n\n    return {\n      inputs,\n      outputs,\n      renderInputs,\n      renderOutputs,\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [\n    elements,\n    elements.length,\n    options.isInputVector,\n    options.isOutputVector,\n  ]);\n\n  return (\n    <div className={styles.wrapper}>\n      <div className={styles.options}>\n        <label className={styles.option}>\n          <input\n            type=\"checkbox\"\n            checked={options.isInputVector}\n            onChange={(e) => {\n              onOptionsChange({\n                isInputVector: e.target.checked,\n              });\n            }}\n          />{' '}\n          Treat input as vector\n        </label>\n        <label className={styles.option}>\n          <input\n            type=\"checkbox\"\n            checked={options.isOutputVector}\n            onChange={(e) => {\n              onOptionsChange({\n                isOutputVector: e.target.checked,\n              });\n            }}\n          />{' '}\n          Treat output as vector\n        </label>\n      </div>\n      <table className={styles.table}>\n        <thead>\n          <tr>\n            {renderInputs.map((el, i) => (\n              <th key={i} className={styles.tableCell}>\n                {getLiteralForSignal(inputs, el, options.isInputVector)}\n              </th>\n            ))}\n            {renderOutputs.map((el, i) => (\n              <th key={i} className={styles.tableCell}>\n                {getLiteralForSignal(outputs, el, options.isOutputVector)}\n              </th>\n            ))}\n          </tr>\n        </thead>\n        <tbody>\n          {Array.from({ length: 2 ** inputs.length }).map((el, rowIndex) => (\n            <tr key={rowIndex}>\n              {renderInputs.map((value, cellIndex) => (\n                <td key={cellIndex}>\n                  {Math.floor(rowIndex / 2 ** (inputs.length - cellIndex - 1)) %\n                    2}\n                </td>\n              ))}\n              {renderOutputs.map((value, i) => (\n                <td key={i}>Z</td>\n              ))}\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n","import type { GameState } from 'common/types';\nimport { elementsDescriptions } from 'common/data';\n\nimport styles from './SchemaErrors.module.scss';\n\ntype Props = {\n  state: GameState;\n};\n\nexport function SchemaErrors({ state }: Props) {\n  const errors = [];\n\n  for (const el of state.elements) {\n    const { pins } = elementsDescriptions[el.type];\n    const used = pins.map(() => false);\n\n    for (const connection of state.connections) {\n      for (const p of connection) {\n        if (p.elId === el.id) {\n          used[p.pinIndex] = true;\n        }\n      }\n    }\n\n    if (used.some((value) => !value)) {\n      errors.push(`Floating pins on node ${el.type}`);\n    }\n  }\n\n  if (!errors.length) {\n    return null;\n  }\n\n  return (\n    <div>\n      <h2 className={styles.title}>Errors:</h2>\n      {errors.map((line, i) => (\n        <div key={i}>{line}</div>\n      ))}\n    </div>\n  );\n}\n","import { CSSProperties, MouseEvent, useEffect, useRef, useState } from 'react';\nimport cn from 'classnames';\n\nimport { useRefState } from 'hooks/useRefState';\nimport { useForceUpdate } from 'hooks/useForceUpdate';\nimport { useHandler } from 'hooks/useHandler';\nimport { useOnChange } from 'hooks/useOnChange';\nimport {\n  Coords,\n  Element,\n  ElementId,\n  ElementType,\n  GameId,\n  GameState,\n  Options,\n} from 'common/types';\nimport { elementsDescriptions } from 'common/data';\nimport { getLiteralForSignal } from 'common/common';\nimport { getCanvasContext } from 'utils/canvas';\nimport { TruthTable } from 'components/TruthTable';\nimport { SchemaErrors } from 'components/SchemaErrors';\n\nimport styles from './Emulator.module.scss';\nimport { useWindowEvent } from '../../hooks/useWindowEvent';\n\nconst ICON_SIZE = 48;\nconst FOCUS_SIZE = ICON_SIZE + 4;\nconst PIN_DOT_RADIUS = 5;\n\ntype Cursor =\n  | 'move'\n  | 'pointer'\n  | 'drag'\n  | 'grab'\n  | 'grabbing'\n  | 'cross'\n  | undefined;\n\ntype HoverTarget = {\n  elId: ElementId;\n  activePin: { index: number } | undefined;\n};\n\nfunction getNextId(state: GameState): ElementId {\n  const lastElement = state.elements[state.elements.length - 1];\n\n  if (!lastElement) {\n    return `el1`;\n  }\n\n  const match = lastElement.id.match(/^el(\\d+)$/);\n\n  if (!match) {\n    throw new Error();\n  }\n\n  return `el${parseInt(match[1], 10) + 1}`;\n}\n\nfunction yesNo(value: unknown) {\n  if (value) {\n    return <span className={styles.yes}>yes</span>;\n  }\n  return <span className={styles.no}>no</span>;\n}\n\nenum LoadingStatus {\n  NONE,\n  LOADING,\n  DONE,\n}\n\ntype AssetSet = {\n  images: Record<string, HTMLImageElement>;\n  status: LoadingStatus;\n};\n\ntype Props = {\n  gameId: GameId;\n};\nexport function Emulator({ gameId }: Props) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const canvasWrapperRef = useRef<HTMLDivElement>(null);\n  const forceUpdate = useForceUpdate();\n  const [cursor, setCursor] = useState<Cursor>();\n  const [options, setOptions] = useState<Options>({\n    isInputVector: false,\n    isOutputVector: false,\n  });\n  const densityFactor = useRefState({ factor: window.devicePixelRatio ?? 1 });\n\n  const size = useRefState({ width: 0, height: 0 });\n  const pos = useRefState({ x: 0, y: 0 });\n  const assets = useRefState<{\n    x1: AssetSet;\n    x2: AssetSet;\n  }>({\n    x1: { images: {}, status: LoadingStatus.NONE },\n    x2: { images: {}, status: LoadingStatus.NONE },\n  });\n  const mousePos = useRefState({ x: 0, y: 0 });\n  const hoverElement = useRefState<{\n    target: HoverTarget | undefined;\n  }>({\n    target: undefined,\n  });\n  const focusElement = useRefState<{ elId: ElementId | undefined }>({\n    elId: undefined,\n  });\n  const movingElement = useRefState<{\n    target: { elId: ElementId } | undefined;\n  }>({\n    target: undefined,\n  });\n  const wireElement = useRefState<{\n    source: { elId: ElementId; pinIndex: number } | undefined;\n  }>({\n    source: undefined,\n  });\n  const state = useRefState<GameState>({\n    elements: [],\n    connections: [],\n  });\n  const mouseState = useRefState({ isMouseDown: false, isDrag: false });\n\n  function convertScreenCoordsToAppCoords({ x, y }: Coords): Coords {\n    return {\n      x: x - size.width / 2 - pos.x,\n      y: y - size.height / 2 - pos.y,\n    };\n  }\n\n  let draw: () => void;\n\n  function clearState() {\n    pos.x = 0;\n    pos.y = 0;\n    state.elements = [];\n    state.connections = [];\n    hoverElement.target = undefined;\n    focusElement.elId = undefined;\n    movingElement.target = undefined;\n    wireElement.source = undefined;\n    mouseState.isDrag = false;\n    mouseState.isMouseDown = false;\n  }\n\n  const loadGameState = useHandler(() => {\n    const json = localStorage.getItem(`sch_game_${gameId}`);\n\n    if (!json) {\n      return;\n    }\n\n    const {\n      pos: savedPos,\n      elements,\n      connections,\n      options: savedOptions,\n    } = JSON.parse(json);\n\n    clearState();\n\n    pos.x = savedPos.x;\n    pos.y = savedPos.y;\n    state.elements = elements;\n    state.connections = connections;\n\n    setOptions(savedOptions);\n\n    window.setTimeout(draw, 0);\n  });\n\n  useEffect(() => {\n    loadGameState();\n\n    const intervalId = window.setInterval(forceUpdate, 500);\n\n    return () => {\n      window.clearInterval(intervalId);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  if (process.env.NODE_ENV === 'development') {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (window as any).state = state;\n  }\n\n  const getElById = useHandler((id: ElementId): Element => {\n    const el = state.elements.find((el) => el.id === id);\n\n    if (!el) {\n      throw new Error('Element not found');\n    }\n\n    return el;\n  });\n\n  draw = useHandler(() => {\n    const ctx = getCanvasContext(canvasRef.current);\n\n    actualizeDensityFactor();\n    const { factor } = densityFactor;\n\n    ctx.save();\n    ctx.clearRect(0, 0, size.width * factor, size.height * factor);\n\n    if (factor === 1) {\n      // used to disable antialiasing for horizontal and vertical lines\n      ctx.translate(0.5, 0.5);\n    } else {\n      ctx.scale(factor, factor);\n    }\n\n    ctx.translate(size.width / 2 + pos.x, size.height / 2 + pos.y);\n\n    for (const element of state.elements) {\n      const { pos } = element;\n\n      if (element.id === hoverElement.target?.elId) {\n        ctx.save();\n        ctx.strokeStyle = '#ddf';\n        ctx.lineWidth = 3;\n        ctx.strokeRect(\n          pos.x - FOCUS_SIZE / 2,\n          pos.y - FOCUS_SIZE / 2,\n          FOCUS_SIZE,\n          FOCUS_SIZE,\n        );\n        ctx.restore();\n      } else if (element.id === focusElement.elId) {\n        ctx.save();\n        ctx.strokeStyle = '#ededf3';\n        ctx.lineWidth = 2;\n        ctx.strokeRect(\n          pos.x - FOCUS_SIZE / 2,\n          pos.y - FOCUS_SIZE / 2,\n          FOCUS_SIZE,\n          FOCUS_SIZE,\n        );\n        ctx.restore();\n      }\n    }\n\n    for (const [p1, p2] of state.connections) {\n      const el1 = getElById(p1.elId);\n      const el2 = getElById(p2.elId);\n\n      const pin1 = elementsDescriptions[el1.type].pins[p1.pinIndex];\n      const pin2 = elementsDescriptions[el2.type].pins[p2.pinIndex];\n\n      ctx.save();\n      ctx.beginPath();\n      ctx.moveTo(\n        el1.pos.x - ICON_SIZE / 2 + pin1.pos.x * ICON_SIZE,\n        el1.pos.y - ICON_SIZE / 2 + pin1.pos.y * ICON_SIZE,\n      );\n      ctx.lineTo(\n        el2.pos.x - ICON_SIZE / 2 + pin2.pos.x * ICON_SIZE,\n        el2.pos.y - ICON_SIZE / 2 + pin2.pos.y * ICON_SIZE,\n      );\n      ctx.strokeStyle = '#333';\n      ctx.stroke();\n      ctx.restore();\n    }\n\n    if (wireElement.source) {\n      const { elId, pinIndex } = wireElement.source;\n      const el = getElById(elId);\n\n      const { pos } = elementsDescriptions[el.type].pins[pinIndex];\n\n      const x0 = pos.x * ICON_SIZE + el.pos.x - ICON_SIZE / 2;\n      const y0 = pos.y * ICON_SIZE + el.pos.y - ICON_SIZE / 2;\n\n      const { x, y } = convertScreenCoordsToAppCoords(mousePos);\n\n      ctx.save();\n      ctx.beginPath();\n      ctx.moveTo(x0, y0);\n      ctx.lineTo(x, y);\n      ctx.strokeStyle = '#888';\n      ctx.stroke();\n      ctx.restore();\n    }\n\n    for (const element of state.elements) {\n      const { type, pos } = element;\n\n      if (type === ElementType.INPUT || type === ElementType.OUTPUT) {\n        const char = getLiteralForSignal(\n          state.elements.filter((el) => el.type === type),\n          element,\n          type === ElementType.INPUT\n            ? options.isInputVector\n            : options.isOutputVector,\n        );\n\n        ctx.save();\n        ctx.textAlign = 'center';\n        ctx.textBaseline = 'middle';\n        ctx.font = '24px sans-serif';\n        if (type === ElementType.INPUT) {\n          ctx.fillText(char, pos.x, pos.y - 10);\n        } else {\n          ctx.fillText(char, pos.x + 6, pos.y);\n        }\n        ctx.restore();\n      } else {\n        const [main, fallback]: ['x1', 'x2'] | ['x2', 'x1'] =\n          factor > 1.5 ? ['x2', 'x1'] : ['x1', 'x2'];\n\n        const img = assets[main].images[type] ?? assets[fallback].images[type];\n\n        if (img) {\n          const x0 = pos.x - ICON_SIZE / 2;\n          const y0 = pos.y - ICON_SIZE / 2;\n\n          ctx.drawImage(img, x0, y0, ICON_SIZE, ICON_SIZE);\n        }\n      }\n\n      const { pins } = elementsDescriptions[type];\n      const activeTarget = hoverElement.target;\n      let i = 0;\n\n      for (const pin of pins) {\n        const isActive =\n          activeTarget &&\n          element.id === activeTarget.elId &&\n          activeTarget.activePin &&\n          activeTarget.activePin.index === i;\n\n        const isWire =\n          wireElement.source &&\n          wireElement.source.elId === element.id &&\n          wireElement.source.pinIndex === i;\n\n        ctx.beginPath();\n        ctx.arc(\n          pos.x + (pin.pos.x - 0.5) * ICON_SIZE,\n          pos.y + (pin.pos.y - 0.5) * ICON_SIZE,\n          isActive ? PIN_DOT_RADIUS + 1 : PIN_DOT_RADIUS,\n          0,\n          Math.PI * 2,\n        );\n        ctx.closePath();\n\n        if (isActive || isWire) {\n          ctx.save();\n          ctx.fillStyle = isWire ? '#d66' : '#66d';\n          ctx.fill();\n          ctx.restore();\n        } else {\n          ctx.save();\n          ctx.fillStyle = '#fff';\n          ctx.fill();\n          ctx.strokeStyle = '#448';\n          ctx.lineWidth = 2;\n          ctx.stroke();\n          ctx.restore();\n        }\n        i += 1;\n      }\n    }\n\n    ctx.restore();\n\n    let currentCursor: Cursor;\n\n    if (wireElement.source) {\n      currentCursor = 'pointer';\n    } else if (hoverElement.target?.activePin) {\n      currentCursor = 'pointer';\n    } else if (hoverElement.target) {\n      currentCursor = 'move';\n    } else if (mouseState.isDrag) {\n      currentCursor = 'grabbing';\n    }\n\n    if (currentCursor !== cursor) {\n      setCursor(currentCursor);\n    }\n  });\n\n  function checkHover(): boolean {\n    const { x, y } = convertScreenCoordsToAppCoords(mousePos);\n    const activeTarget = hoverElement.target;\n\n    for (const element of state.elements) {\n      const { pins } = elementsDescriptions[element.type];\n\n      const x0 = element.pos.x - ICON_SIZE / 2;\n      const y0 = element.pos.y - ICON_SIZE / 2;\n\n      for (const pin of pins) {\n        if (\n          (x0 + pin.pos.x * ICON_SIZE - x) ** 2 +\n            (y0 + pin.pos.y * ICON_SIZE - y) ** 2 <\n          (PIN_DOT_RADIUS + 4) ** 2\n        ) {\n          const pinIndex = pins.indexOf(pin);\n          const hoverTarget = hoverElement.target;\n\n          if (\n            !hoverTarget ||\n            hoverTarget.elId !== element.id ||\n            hoverTarget.activePin?.index !== pinIndex\n          ) {\n            hoverElement.target = {\n              elId: element.id,\n              activePin: {\n                index: pinIndex,\n              },\n            };\n            return true;\n          }\n          return false;\n        }\n      }\n    }\n\n    for (const element of state.elements) {\n      const x0 = element.pos.x - ICON_SIZE / 2;\n      const y0 = element.pos.y - ICON_SIZE / 2;\n\n      if (x > x0 && x < x0 + ICON_SIZE && y > y0 && y < y0 + ICON_SIZE) {\n        if (\n          !activeTarget ||\n          activeTarget.elId !== element.id ||\n          activeTarget.activePin\n        ) {\n          hoverElement.target = {\n            elId: element.id,\n            activePin: undefined,\n          };\n          return true;\n        }\n        return false;\n      }\n    }\n\n    if (hoverElement.target) {\n      hoverElement.target = undefined;\n      return true;\n    }\n\n    return false;\n  }\n\n  function actualizeDensityFactor() {\n    const factor = window.devicePixelRatio ?? 1;\n\n    if (densityFactor.factor !== factor) {\n      densityFactor.factor = factor;\n      forceUpdate();\n    }\n  }\n\n  function updateSize() {\n    const app = canvasWrapperRef.current;\n    const canvas = canvasRef.current;\n\n    if (!app || !canvas) {\n      throw new Error();\n    }\n\n    if (size.width !== app.clientWidth || size.height !== app.clientHeight) {\n      size.width = app.clientWidth;\n      size.height = app.clientHeight;\n\n      draw();\n    }\n  }\n\n  function checkOverlap(point: Coords): boolean {\n    for (const { pos } of state.elements) {\n      if (\n        (pos.x - point.x) ** 2 + (pos.y - point.y) ** 2 <\n        (ICON_SIZE / 2) ** 2\n      ) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function addElement(type: ElementType) {\n    const pos = convertScreenCoordsToAppCoords({\n      x: size.width / 2,\n      y: size.height / 2,\n    });\n\n    while (checkOverlap(pos)) {\n      pos.x += ICON_SIZE + 20;\n    }\n\n    state.elements.push({\n      type,\n      id: getNextId(state),\n      pos,\n    });\n    draw();\n  }\n\n  function loadAssets() {\n    const is2x = densityFactor.factor > 1.5;\n\n    const assetsSet = assets[is2x ? 'x1' : 'x2'];\n\n    if (assetsSet.status !== LoadingStatus.NONE) {\n      return;\n    }\n\n    const loadImages = [\n      ElementType.PNP,\n      ElementType.NPN,\n      ElementType.POWER,\n      ElementType.GROUND,\n    ];\n\n    let remainLoad = loadImages.length;\n\n    function onLoad() {\n      remainLoad -= 1;\n\n      if (remainLoad === 0) {\n        assetsSet.status = LoadingStatus.DONE;\n        draw();\n      }\n    }\n\n    assetsSet.status = LoadingStatus.LOADING;\n\n    for (const imgName of loadImages) {\n      const image = new Image();\n      image.src = `assets/${imgName}${is2x ? '@2x' : ''}.png`;\n      image.addEventListener('load', () => {\n        assetsSet.images[imgName] = image;\n        onLoad();\n      });\n      image.addEventListener('error', onLoad);\n    }\n  }\n\n  useEffect(() => {\n    updateSize();\n    loadAssets();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useOnChange(loadAssets, [densityFactor.factor]);\n\n  useWindowEvent('resize', () => {\n    setTimeout(() => {\n      actualizeDensityFactor();\n      updateSize();\n    }, 0);\n  });\n\n  useOnChange(draw, [options]);\n\n  function resetCursorState() {\n    let needRepaint = false;\n\n    if (mouseState.isMouseDown) {\n      mouseState.isMouseDown = false;\n    }\n\n    if (movingElement.target) {\n      movingElement.target = undefined;\n      needRepaint = true;\n    }\n\n    if (mouseState.isDrag) {\n      mouseState.isDrag = false;\n      needRepaint = true;\n    }\n\n    if (wireElement.source) {\n      wireElement.source = undefined;\n      needRepaint = true;\n    }\n\n    return needRepaint;\n  }\n\n  function startWiring({\n    elId,\n    pinIndex,\n  }: {\n    elId: ElementId;\n    pinIndex: number;\n  }) {\n    focusElement.elId = elId;\n    wireElement.source = {\n      elId,\n      pinIndex,\n    };\n    // state.connections = state.connections.filter(\n    //   ([p1, p2]) => p1.elId !== elId && p2.elId !== elId,\n    // );\n  }\n\n  const onMouseUp = useHandler((e?: MouseEvent) => {\n    if (e) {\n      e.preventDefault();\n\n      if (e.button !== 0) {\n        return;\n      }\n    }\n\n    let needRepaint = false;\n\n    mouseState.isMouseDown = false;\n\n    if (focusElement.elId && !wireElement.source && !movingElement.target) {\n      focusElement.elId = undefined;\n      needRepaint = true;\n    }\n\n    if (movingElement.target) {\n      movingElement.target = undefined;\n      needRepaint = true;\n    }\n\n    if (mouseState.isDrag) {\n      mouseState.isDrag = false;\n      needRepaint = true;\n    }\n\n    if (wireElement.source) {\n      const activeTarget = hoverElement.target;\n\n      if (\n        activeTarget &&\n        activeTarget.activePin &&\n        wireElement.source.elId !== activeTarget.elId\n      ) {\n        state.connections.push([\n          {\n            elId: activeTarget.elId,\n            pinIndex: activeTarget.activePin.index,\n          },\n          {\n            elId: wireElement.source.elId,\n            pinIndex: wireElement.source.pinIndex,\n          },\n        ]);\n      }\n\n      wireElement.source = undefined;\n      needRepaint = true;\n    } else if (!wireElement.source) {\n      const hoverTarget = hoverElement.target;\n\n      if (hoverTarget && hoverTarget.activePin) {\n        startWiring({\n          elId: hoverTarget.elId,\n          pinIndex: hoverTarget.activePin.index,\n        });\n        needRepaint = true;\n      }\n\n      if (hoverTarget && !hoverTarget.activePin) {\n        if (focusElement.elId !== hoverTarget.elId) {\n          focusElement.elId = hoverTarget.elId;\n          needRepaint = true;\n        }\n      }\n    }\n\n    if (needRepaint) {\n      draw();\n    }\n  });\n\n  return (\n    <main className={styles.app}>\n      <div ref={canvasWrapperRef} className={styles.canvasWrapper}>\n        <canvas\n          ref={canvasRef}\n          className={cn(styles.canvas, {\n            [styles.canvasScale]: densityFactor.factor !== 1,\n          })}\n          width={size.width * densityFactor.factor}\n          height={size.height * densityFactor.factor}\n          style={\n            {\n              '--factor': 1 / densityFactor.factor,\n              cursor,\n            } as CSSProperties\n          }\n          onClick={(e) => {\n            e.preventDefault();\n          }}\n          onMouseDown={(e) => {\n            e.preventDefault();\n\n            if (e.button !== 0) {\n              return;\n            }\n\n            if (mouseState.isMouseDown) {\n              onMouseUp();\n            }\n\n            mouseState.isMouseDown = true;\n          }}\n          onMouseMove={(e) => {\n            mousePos.x = e.clientX;\n            mousePos.y = e.clientY;\n\n            let needRepaint = false;\n\n            if (checkHover()) {\n              needRepaint = true;\n            }\n\n            const isMoving = Boolean(movingElement.target);\n            const hoverTarget = hoverElement.target;\n\n            if (mouseState.isMouseDown) {\n              if (\n                !isMoving &&\n                !wireElement.source &&\n                hoverTarget &&\n                hoverTarget.activePin\n              ) {\n                startWiring({\n                  elId: hoverTarget.elId,\n                  pinIndex: hoverTarget.activePin.index,\n                });\n                needRepaint = true;\n              }\n\n              if (!isMoving && wireElement.source) {\n                needRepaint = true;\n              }\n\n              if (!isMoving && !wireElement.source && hoverTarget) {\n                movingElement.target = {\n                  elId: hoverTarget.elId,\n                };\n                focusElement.elId = hoverTarget.elId;\n                needRepaint = true;\n              }\n\n              if (\n                !wireElement.source &&\n                !movingElement.target &&\n                !mouseState.isDrag\n              ) {\n                mouseState.isDrag = true;\n                needRepaint = true;\n              }\n\n              if (movingElement.target) {\n                const el = getElById(movingElement.target.elId);\n                el.pos.x += e.movementX;\n                el.pos.y += e.movementY;\n              } else if (!wireElement.source) {\n                pos.x += e.movementX;\n                pos.y += e.movementY;\n              }\n\n              needRepaint = true;\n            } else {\n              if (mouseState.isDrag) {\n                mouseState.isDrag = false;\n                needRepaint = true;\n              }\n            }\n\n            if (wireElement.source) {\n              needRepaint = true;\n            }\n\n            if (needRepaint) {\n              draw();\n            }\n          }}\n          onMouseUp={onMouseUp}\n          onMouseLeave={() => {\n            if (resetCursorState()) {\n              draw();\n            }\n          }}\n          onContextMenu={(e) => {\n            if (\n              hoverElement.target ||\n              wireElement.source ||\n              mouseState.isDrag\n            ) {\n              e.preventDefault();\n            }\n          }}\n        />\n      </div>\n      <div className={styles.panel}>\n        <button\n          type=\"button\"\n          className={styles.button}\n          onClick={(e) => {\n            e.preventDefault();\n            addElement(ElementType.POWER);\n          }}\n        >\n          DD\n        </button>\n        <button\n          type=\"button\"\n          className={styles.button}\n          onClick={(e) => {\n            e.preventDefault();\n            addElement(ElementType.GROUND);\n          }}\n        >\n          GND\n        </button>\n        <button\n          type=\"button\"\n          className={styles.button}\n          onClick={(e) => {\n            e.preventDefault();\n            addElement(ElementType.NPN);\n          }}\n        >\n          npn\n        </button>\n        <button\n          type=\"button\"\n          className={styles.button}\n          onClick={(e) => {\n            e.preventDefault();\n            addElement(ElementType.PNP);\n          }}\n        >\n          pnp\n        </button>\n        <button\n          type=\"button\"\n          className={styles.button}\n          onClick={(e) => {\n            e.preventDefault();\n            addElement(ElementType.INPUT);\n          }}\n        >\n          input\n        </button>\n        <button\n          type=\"button\"\n          className={styles.button}\n          onClick={(e) => {\n            e.preventDefault();\n            addElement(ElementType.OUTPUT);\n          }}\n        >\n          output\n        </button>\n        <button\n          type=\"button\"\n          className={styles.button}\n          onClick={(e) => {\n            e.preventDefault();\n            addElement(ElementType.DOT);\n          }}\n        >\n          dot\n        </button>\n        <span className={styles.divider} />\n        <button\n          type=\"button\"\n          className={styles.button}\n          onClick={(e) => {\n            e.preventDefault();\n            loadGameState();\n          }}\n        >\n          Load\n        </button>\n        <button\n          type=\"button\"\n          className={styles.button}\n          onClick={(e) => {\n            e.preventDefault();\n            localStorage.setItem(\n              `sch_game_${gameId}`,\n              JSON.stringify({\n                pos,\n                elements: state.elements,\n                connections: state.connections,\n                options,\n              }),\n            );\n            // eslint-disable-next-line no-console\n            console.info('Saved');\n          }}\n        >\n          Save\n        </button>\n        <button\n          type=\"button\"\n          className={styles.button}\n          onClick={(e) => {\n            e.preventDefault();\n            clearState();\n            draw();\n          }}\n        >\n          Clear\n        </button>\n        {/* eslint-disable-next-line jsx-a11y/anchor-is-valid */}\n        <a href=\"#\">\n          <button type=\"button\" className={styles.button}>\n            Exit\n          </button>\n        </a>\n      </div>\n      <div className={styles.info}>\n        <TruthTable\n          elements={state.elements}\n          options={options}\n          onOptionsChange={(update) =>\n            setOptions({\n              ...options,\n              ...update,\n            })\n          }\n        />\n        <SchemaErrors state={state} />\n        <span className={styles.space} />\n        <div className={styles.debugPanel}>\n          <div>elements: {state.elements.length}</div>\n          <div>connections: {state.connections.length}</div>\n          <div>el moving: {yesNo(movingElement.target)}</div>\n          <div>el in focus: {yesNo(focusElement.elId)}</div>\n          <div>el hover: {yesNo(hoverElement.target)}</div>\n          <div>pin hover: {yesNo(hoverElement.target?.activePin)}</div>\n          <div>wiring: {yesNo(wireElement.source)}</div>\n          <div>drag: {yesNo(mouseState.isDrag)}</div>\n          <div>mouse down: {yesNo(mouseState.isMouseDown)}</div>\n        </div>\n      </div>\n    </main>\n  );\n}\n","import { useCallback, useRef, useState } from 'react';\n\nexport function useForceUpdate() {\n  const incRef = useRef(0);\n  const [, setInc] = useState(incRef.current);\n\n  return useCallback(() => {\n    incRef.current += 1;\n    setInc(incRef.current);\n  }, []);\n}\n","export function getCanvasContext(\n  canvas: HTMLCanvasElement | null | undefined,\n): CanvasRenderingContext2D {\n  if (!canvas) {\n    throw new Error();\n  }\n\n  const ctx = canvas.getContext('2d');\n\n  if (!ctx) {\n    throw new Error();\n  }\n\n  return ctx;\n}\n","import { useMemo, useState } from 'react';\n\nimport { GameId } from 'common/types';\nimport { useOnChange } from 'hooks/useOnChange';\nimport { useWindowEvent } from 'hooks/useWindowEvent';\nimport { Emulator } from 'components/Emulator';\n\nimport styles from './App.module.scss';\n\nfunction getCurrentGameId(allowedIds: GameId[]): GameId | undefined {\n  const hash = (window.location.hash ?? '').trim().replace(/^#/, '');\n\n  if (hash) {\n    const match = hash.match(/^g(\\d+)$/);\n\n    if (match) {\n      const id = match[0] as GameId;\n\n      if (allowedIds.includes(id)) {\n        return id;\n      }\n    }\n  }\n\n  return undefined;\n}\n\nfunction getNextGameId(currentGames: GameId[]): GameId {\n  const lastId = currentGames[currentGames.length - 1];\n\n  if (!lastId) {\n    return `g1`;\n  }\n\n  const match = lastId.match(/^g(\\d+)$/);\n\n  if (!match) {\n    throw new Error();\n  }\n\n  return `g${parseInt(match[1], 10) + 1}`;\n}\n\nexport function App() {\n  const savedGames = useMemo<GameId[]>(() => {\n    const json = localStorage.getItem('sch_games');\n    if (!json) {\n      return [];\n    }\n    return JSON.parse(json);\n  }, []);\n  const [currentGames, setCurrentGames] = useState(savedGames);\n\n  useOnChange(() => {\n    localStorage.setItem('sch_games', JSON.stringify(currentGames));\n  }, [currentGames]);\n\n  const [currentGameId, setCurrentGameId] = useState(\n    getCurrentGameId(currentGames),\n  );\n\n  useWindowEvent('hashchange', () => {\n    const gameId = getCurrentGameId(currentGames);\n\n    if (gameId !== currentGameId) {\n      setCurrentGameId(gameId);\n    }\n  });\n\n  if (currentGameId) {\n    return <Emulator key={currentGameId} gameId={currentGameId} />;\n  }\n\n  return (\n    <div className={styles.wrapper}>\n      <h1 className={styles.title}>Schematic</h1>\n      <h2 className={styles.gamesTitle}>Current schemas:</h2>\n      <ul>\n        {currentGames.length ? (\n          currentGames.map((gameId) => (\n            <li key={gameId}>\n              <a href={`#${gameId}`}>{gameId}</a>{' '}\n              <button\n                type=\"button\"\n                className={styles.removeButton}\n                onClick={(e) => {\n                  e.preventDefault();\n\n                  // eslint-disable-next-line no-alert\n                  if (window.confirm('Are you sure?')) {\n                    setCurrentGames(currentGames.filter((id) => id !== gameId));\n                    localStorage.removeItem(`sch_game_${gameId}`);\n                  }\n                }}\n              >\n                x\n              </button>\n            </li>\n          ))\n        ) : (\n          <div>no saved schemas</div>\n        )}\n      </ul>\n      <button\n        type=\"button\"\n        onClick={(e) => {\n          e.preventDefault();\n          const newGameId = getNextGameId(currentGames);\n          setCurrentGames([...currentGames, newGameId]);\n\n          window.setTimeout(() => {\n            window.location.assign(`#${newGameId}`);\n          }, 0);\n        }}\n      >\n        New schema\n      </button>\n    </div>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './index.scss';\nimport { App } from './components/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapper\":\"TruthTable_wrapper__23wrn\",\"options\":\"TruthTable_options__kzZt2\",\"option\":\"TruthTable_option__1Hqnt\"};"],"sourceRoot":""}